-- Create admins table
CREATE TABLE public.admins (
  id uuid NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  email text NOT NULL UNIQUE,
  password text NOT NULL,
  name text,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  updated_at timestamp with time zone NOT NULL DEFAULT now()
);

-- Enable RLS on admins table
ALTER TABLE public.admins ENABLE ROW LEVEL SECURITY;

-- Create policy for admins to view their own data
CREATE POLICY "Admins can view their own data" 
ON public.admins 
FOR SELECT 
USING (email = auth.jwt() ->> 'email');

-- Insert the first admin
INSERT INTO public.admins (email, password, name) VALUES 
('alinasreldin783@gmail.com', crypt('Alinasr89#', gen_salt('bf')), 'المدير العام');

-- Insert sample teachers data
INSERT INTO public.teachers (name, specialization, rating, reviews, hourly_rate, experience, languages, image_url, is_online, bio, education, certifications) VALUES 
(
  'سارة أحمد', 
  'محادثة وقواعد', 
  4.9, 
  127, 
  150, 
  5, 
  ARRAY['العربية', 'الإنجليزية', 'الفرنسية'],
  '/src/assets/teacher-sarah.jpg',
  true,
  'معلمة لغة إنجليزية محترفة مع خبرة 5 سنوات في تدريس المحادثة والقواعد. متخصصة في مساعدة الطلاب على اكتساب الثقة في التحدث باللغة الإنجليزية.',
  'بكالوريوس اللغة الإنجليزية - جامعة القاهرة',
  ARRAY['شهادة TESOL', 'شهادة تدريس اللغة الإنجليزية كلغة أجنبية']
),
(
  'مايكل جونسون', 
  'IELTS & TOEFL', 
  4.8, 
  203, 
  200, 
  8, 
  ARRAY['الإنجليزية', 'الإسبانية'],
  '/src/assets/teacher-michael.jpg',
  false,
  'خبير في تحضير امتحانات IELTS وTOEFL مع 8 سنوات من الخبرة. ساعد أكثر من 500 طالب على تحقيق درجاتهم المستهدفة.',
  'ماجستير اللغويات التطبيقية - جامعة كامبريدج',
  ARRAY['شهادة IELTS الرسمية', 'شهادة TOEFL المعتمدة', 'شهادة Cambridge CELTA']
),
(
  'إيما سميث', 
  'إنجليزية الأعمال', 
  4.7, 
  89, 
  180, 
  3, 
  ARRAY['الإنجليزية', 'الألمانية'],
  '/src/assets/teacher-emma.jpg',
  true,
  'متخصصة في إنجليزية الأعمال والتواصل المهني. تساعد المهنيين على تطوير مهاراتهم اللغوية في بيئة العمل.',
  'بكالوريوس إدارة الأعمال - جامعة لندن',
  ARRAY['شهادة Business English', 'شهادة Professional Communication']
),
(
  'أحمد محمد', 
  'قواعد اللغة', 
  4.6, 
  156, 
  120, 
  4, 
  ARRAY['العربية', 'الإنجليزية'],
  '/src/assets/teacher-sarah.jpg',
  true,
  'مدرس قواعد اللغة الإنجليزية مع التركيز على التطبيق العملي. يستخدم طرق تدريس مبتكرة لجعل القواعد سهلة الفهم.',
  'بكالوريوس اللغة الإنجليزية - الجامعة الأمريكية بالقاهرة',
  ARRAY['شهادة TESOL', 'دبلوم تدريس اللغة الإنجليزية']
),
(
  'فاطمة علي', 
  'اللهجة الأمريكية', 
  4.8, 
  92, 
  160, 
  6, 
  ARRAY['العربية', 'الإنجليزية'],
  '/src/assets/teacher-emma.jpg',
  true,
  'متخصصة في تعليم اللهجة الأمريكية والنطق الصحيح. عاشت في أمريكا لمدة 10 سنوات وتجيد تعليم النطق الأمريكي الأصيل.',
  'ماجستير اللغة الإنجليزية - جامعة كاليفورنيا',
  ARRAY['شهادة American Accent Training', 'شهادة Pronunciation Specialist']
);

-- Insert sample courses data
INSERT INTO public.courses (title, description, level, duration, students, rating, price, instructor, category, features, content_outline, prerequisites) VALUES 
(
  'المحادثة الإنجليزية للمبتدئين',
  'تعلم أساسيات المحادثة الإنجليزية من الصفر مع التركيز على النطق الصحيح والثقة في التحدث',
  'مبتدئ',
  '8 أسابيع',
  1250,
  4.8,
  1200,
  'سارة أحمد',
  'محادثة',
  ARRAY['دروس تفاعلية', 'ممارسة يومية', 'شهادة معتمدة', 'مراجعة أسبوعية'],
  ARRAY['التحيات والتعريف بالنفس', 'الأرقام والوقت', 'المشاعر والحالات', 'الطعام والمشروبات', 'التسوق والأسعار', 'العائلة والأصدقاء', 'الهوايات والأنشطة', 'السؤال عن الطريق'],
  ARRAY['لا توجد متطلبات مسبقة', 'الرغبة في التعلم']
),
(
  'IELTS التحضير الشامل',
  'دورة متكاملة للتحضير لامتحان IELTS مع استراتيجيات مثبتة لتحقيق أعلى الدرجات',
  'متقدم',
  '12 أسبوع',
  890,
  4.9,
  2400,
  'مايكل جونسون',
  'امتحانات',
  ARRAY['امتحانات تجريبية', 'تقييم شخصي', 'ضمان النتيجة', 'مواد حصرية'],
  ARRAY['مقدمة عن IELTS وهيكل الامتحان', 'استراتيجيات الاستماع', 'تقنيات القراءة السريعة', 'الكتابة الأكاديمية Task 1', 'الكتابة الأكاديمية Task 2', 'مهارات المحادثة الجزء الأول', 'مهارات المحادثة الجزء الثاني', 'مهارات المحادثة الجزء الثالث', 'امتحانات تجريبية', 'تقييم ومراجعة النتائج'],
  ARRAY['مستوى متوسط في اللغة الإنجليزية', 'إلمام بالقواعد الأساسية']
),
(
  'إنجليزية الأعمال المتقدمة',
  'طور مهاراتك في الإنجليزية المهنية للتفوق في بيئة العمل والحصول على فرص أفضل',
  'متوسط',
  '10 أسابيع',
  675,
  4.7,
  1800,
  'إيما سميث',
  'أعمال',
  ARRAY['مهارات العرض', 'كتابة المراسلات', 'مقابلات العمل', 'التفاوض باللغة الإنجليزية'],
  ARRAY['مصطلحات الأعمال الأساسية', 'كتابة الإيميلات المهنية', 'إجراء المكالمات التجارية', 'العروض التقديمية', 'الاجتماعات والمؤتمرات', 'التفاوض والمبيعات', 'مقابلات العمل', 'كتابة التقارير', 'التواصل مع العملاء'],
  ARRAY['مستوى أساسي في اللغة الإنجليزية', 'خبرة عمل أساسية']
),
(
  'القواعد الإنجليزية المبسطة',
  'اتقن قواعد اللغة الإنجليزية بطريقة سهلة ومفهومة مع تمارين تطبيقية شاملة',
  'مبتدئ',
  '6 أسابيع',
  1500,
  4.6,
  800,
  'أحمد محمد',
  'قواعد',
  ARRAY['شرح مبسط', 'تمارين متدرجة', 'مراجعة مستمرة', 'أمثلة عملية'],
  ARRAY['الضمائر وأنواعها', 'الأزمنة البسيطة', 'الأفعال المساعدة', 'تكوين الأسئلة', 'النفي في الإنجليزية', 'الصفات والظروف', 'حروف الجر', 'الجمل المركبة'],
  ARRAY['لا توجد متطلبات مسبقة']
),
(
  'النطق والاكسنت الأمريكي',
  'أتقن النطق الأمريكي الصحيح وتخلص من الأخطاء الشائعة في النطق',
  'متوسط',
  '8 أسابيع',
  420,
  4.8,
  1500,
  'فاطمة علي',
  'محادثة',
  ARRAY['تدريب على النطق', 'تسجيلات صوتية', 'تمارين عملية', 'متابعة شخصية'],
  ARRAY['أساسيات النطق الأمريكي', 'الأصوات الساكنة', 'الأصوات المتحركة', 'التشديد والإيقاع', 'الربط بين الكلمات', 'النبرة في الجمل', 'التمييز بين الأصوات المتشابهة', 'الممارسة العملية'],
  ARRAY['مستوى أساسي في اللغة الإنجليزية']
);

-- Add trigger for updated_at on admins table
CREATE TRIGGER update_admins_updated_at
BEFORE UPDATE ON public.admins
FOR EACH ROW
EXECUTE FUNCTION public.update_updated_at_column();